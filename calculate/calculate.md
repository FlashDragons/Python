Sorry for the chaotic code.
